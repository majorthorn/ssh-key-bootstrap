{
  "name": "vibe-ssh-lift Go",
  "image": "golang:1.26",

  "customizations": {
    "vscode": {
      "extensions": [
        "golang.Go",
        "golangci-lint.vscode-golangci-lint",
        "openai.chatgpt"
      ],
      "settings": {
        "go.formatTool": "gofmt",
        "go.useLanguageServer": true,
        "go.lintTool": "golangci-lint",
        "go.autocompleteUnimportedPackages": true,
        "terminal.integrated.defaultProfile.linux": "bash",
        "files.watcherExclude": {
          "**/.devcontainer/**": true,
          "**/.git/**": true,
          "**/build/**": true,
          "**/dist/**": true
        }
      }
    }
  },

  "workspaceFolder": "/workspace",
  "workspaceMount": "source=${localWorkspaceFolder},target=/workspace,type=bind",

  "mounts": [
    "source=go-mod-cache,target=/go/pkg/mod,type=volume",
    "source=${localEnv:HOME}/.gitconfig,target=/home/vscode/.gitconfig,type=bind,consistency=cached",
    "source=${localEnv:HOME}/.gitconfig,target=/root/.gitconfig,type=bind,consistency=cached"
  ],

  "runArgs": [
    "--security-opt",
    "no-new-privileges"
  ],

  "containerEnv": {
    "GOWORK": "off",
    "SSH_AUTH_SOCK": "/ssh-agent"
  },
  "remoteEnv": {
    "PATH": "/go/bin:${containerEnv:PATH}",
    "GIT_USER": "${localEnv:GIT_USER}",
    "GIT_EMAIL": "${localEnv:GIT_EMAIL}"
  },

  "postCreateCommand": "mkdir -p ~/.ssh && (ssh-keyscan github.com >> ~/.ssh/known_hosts 2>/dev/null || true) && bash .devcontainer/post-create.sh"
}
